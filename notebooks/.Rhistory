library(sp)
library(sf)
library(spdep)
library(rgdal)
library(gdalUtils)
library(PerformanceAnalytics)
library(stringr)
library(tmap)
library(mapview)
library(leaflet)
library(ggplot2)
library(RColorBrewer)
path <- '../data/raw/descriptUnidadAnalisis/'
file_list <- list.files(paste(path, 'edafico', sep = ''))
file_list <- str_remove_all(file_list, '.gpkg')
# Cargo el primer .gpkg para usarlo de base
for (filename in file_list[1]){
data <- readOGR(
dsn = paste(path, 'edafico/', filename, '.gpkg', sep = ''),
layer = filename
)
}
# Cargo el resto de los .gpkg y los voy uniendo a `data` a medida que los cargo
for (filename in file_list[2:length(file_list)]){
temp <- readOGR(
dsn = paste(path, 'edafico/', filename, '.gpkg', sep = ''),
layer = filename
)
data <- merge(x = data, y = as.data.frame(temp))
}
dim(data); dim(temp)
class(data); class(temp)
names(data)
head(data, 2)
file_list <- list.files(paste(path, sep = ''))
file_list <- str_remove_all(file_list, '.gpkg') # quito la extension
file_list <- file_list[file_list != 'edafico'] # edafico es una carpeta
for (filename in file_list){
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
data <- merge(x = data, y = as.data.frame(temp))
}
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'CIC'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_CIC <- replace(temp$Media_CIC, temp$Media_CIC == -Inf, NA)
qtm(shp = temp, fill = 'Media_CIC')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
temp$Mediana_CIC <- replace(temp$Mediana_CIC, temp$Mediana_CIC == -Inf, NA)
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_CIC)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_CIC)) +
geom_histogram(binwidth = 0.5)
qtm(shp = temp, fill = 'Media_CIC')
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_CIC, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'CO'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_CO <- replace(temp$Media_CO, temp$Media_CO == -Inf, NA)
qtm(shp = temp, fill = 'Media_CO')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_CO)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_CO)) +
geom_histogram(binwidth = 0.5)
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_CO, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Cu'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Cu <- replace(temp$Media_Cu, temp$Media_Cu == -Inf, NA)
qtm(shp = temp, fill = 'Media_Cu')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Cu)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_Cu)) +
geom_histogram(binwidth = 0.5)
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_Cu, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Fe'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Fe <- replace(temp$Media_Fe, temp$Media_Fe == -Inf, NA)
qtm(shp = temp, fill = 'Media_Fe')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Fe)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_Fe)) +
geom_histogram(binwidth = 0.5)
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_Fe, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'K'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_K <- replace(temp$Media_K, temp$Media_K == -Inf, NA)
qtm(shp = temp, fill = 'Media_K')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_K)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_K)) +
geom_histogram(binwidth = 0.5)
mapview(temp)
mapview(temp, zcol = 'Media_K')
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_K, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'LIMO'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_LIMO <- replace(temp$Media_LIMO, temp$Media_LIMO == -Inf, NA)
qtm(shp = temp, fill = 'Media_LIMO')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_LIMO)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_LIMO)) +
geom_histogram(binwidth = 0.5)
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_LIMO, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Mg'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Mg <- replace(temp$Media_Mg, temp$Media_Mg == -Inf, NA)
qtm(shp = temp, fill = 'Media_Mg')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Mg)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_Mg)) +
geom_histogram(binwidth = 0.5)
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_Mg, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Mn'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Mn <- replace(temp$Media_Mn, temp$Media_Mn == -Inf, NA)
qtm(shp = temp, fill = 'Media_Mn')
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Na'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Na <- replace(temp$Media_Na, temp$Media_Na == -Inf, NA)
qtm(shp = temp, fill = 'Media_Na')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Mn)) +
geom_histogram(binwidth = 0.5)
mapview(temp, zcol = 'Media_Na')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Na)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_Na)) +
geom_histogram(binwidth = 0.5)
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_Na, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Nt'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Nt <- replace(temp$Media_Nt, temp$Media_Nt == -Inf, NA)
qtm(shp = temp, fill = 'Media_Nt')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Nt)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_Nt)) +
geom_histogram(binwidth = 0.5)
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'P'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_P <- replace(temp$Media_P, temp$Media_P == -Inf, NA)
qtm(shp = temp, fill = 'Media_P')
mapview(temp, zcol = 'Media_P')
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'pH'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_pH <- replace(temp$Media_pH, temp$Media_pH == -Inf, NA)
qtm(shp = temp, fill = 'Media_pH')
ggplot(as.data.frame(temp), aes(x = Media_pH)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_pH)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Media_pH)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_pH)) +
geom_histogram(binwidth = 0.5)
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Zn'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Zn <- replace(temp$Media_Zn, temp$Media_Zn == -Inf, NA)
qtm(shp = temp, fill = 'Media_Zn')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Zn)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_Zn)) +
geom_histogram(binwidth = 0.5)
nb <- poly2nb(pl = temp, queen = TRUE)
w <- nb2listw(neighbours = nb, style = 'W', zero.policy = TRUE)
imoran <- moran.mc(x = temp$Media_Zn, listw = w, nsim = 1000,
zero.policy = T, na.action = na.omit)
plot(imoran)
imoran$p.value
path_ed <- paste(path, 'edafico/', sep = '')
filename <- 'Cobertura_N3_descript_'
temp <- readOGR(
dsn = paste(path_ed, filename, '.gpkg', sep = ''),
layer = filename
)
filename <- 'Cobertura_N3_descript_'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
path
filename <- 'Cobertura_N3_descrpt_'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_CE <- replace(temp$Media_CE, temp$Media_CE == -Inf, NA)
names(temp)
mapview(temp, zcol = 'Sorgo_Porc)
mapview(temp, zcol = 'Sorgo_Porc')
qtm(shp = temp, fill = 'Sorgo_Porc')
mapview(temp, zcol = 'Sorgo_Porc')
mapview(temp, zcol = 'Cultivos.anuales.irrigados_Porc')
filename <- 'Cobertura_N25_descrpt_'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
path
filename <- 'Cobertura_N25_descrpt_'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
filename <- 'Cobertura_N25_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_CE <- replace(temp$Media_CE, temp$Media_CE == -Inf, NA)
names(temp)
qtm(shp = temp, fill = 'Sin.actividad.significativa_Porc')
qtm(shp = temp, fill = 'Actividades.estivales_Porc')
qtm(shp = temp, fill = 'Zonas.anegables_Porc')
filename <- 'DEM_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_DEM <- replace(temp$Media_DEM, temp$Media_DEM == -Inf, NA)
temp$Mediana_DEM <- replace(temp$Mediana_DEM, temp$Mediana_DEM == -Inf, NA)
qtm(shp = temp, fill = 'Media_DEM')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
filename
media <- paste('Media_', 'DEM', sep = '')
mediana <- paste('Mediana_', 'DEM', sep = '')
summary(temp[, c(media, mediana)])
media <- paste('Media_', 'DEM', sep = '')
mediana <- paste('Mediana_', 'DEM', sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_DEM)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_DEM)) +
geom_histogram(binwidth = 0.5)
filename <- 'ESPI_Ltt_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_ESPI.LTT <- replace(temp$Media_ESPI.LTT, temp$Media_ESPI.LTT == -Inf, NA)
temp$Mediana_ESPI.LTT <- replace(temp$Mediana_ESPI.LTT, temp$Mediana_ESPI.LTT == -Inf, NA)
qtm(shp = temp, fill = 'Media_ESPI.LTT')
media <- 'Media_ESPI.LTT'
mediana <- 'Mediana_ESPI.LTT'
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_ESPI.LTT)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_ESPI.LTT)) +
geom_histogram(binwidth = 0.5)
filename <- 'ESPI_Mean_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_ESPI.LTT <- replace(temp$Media_ESPI.LTT, temp$Media_ESPI.LTT == -Inf, NA)
qtm(shp = temp, fill = 'Media_ESPI.LTT')
qtm(shp = temp, fill = 'Media_ESPI.Mean')
media <- 'Media_ESPI.Mean'
mediana <- 'Mediana_ESPI.Mean'
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_ESPI.Mean)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_ESPI.Mean)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Media_ESPI.Mean)) +
geom_histogram(binwidth = 0.01)
ggplot(as.data.frame(temp), aes(x = Mediana_ESPI.Mean)) +
geom_histogram(binwidth = 0.01)
ggplot(as.data.frame(temp), aes(x = Media_ESPI.LTT)) +
geom_histogram(binwidth = 0.05)
filename <- 'LPD_descrpt_'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
filename <- 'LPD_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_LPD <- replace(temp$Media_LPD, temp$Media_LPD == -Inf, NA)
temp$Mediana_LPD <- replace(temp$Mediana_LPD, temp$Mediana_LPD == -Inf, NA)
qtm(shp = temp, fill = 'Media_LPD')
mapview(temp, zcol = 'Media_LPD')
filename <- 'NDVI_Ltt_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_NDVI.LTT <- replace(temp$Media_NDVI.LTT, temp$Media_NDVI.LTT == -Inf, NA)
temp$Mediana_NDVI.LTT <- replace(temp$Mediana_NDVI.LTT, temp$Mediana_NDVI.LTT == -Inf, NA)
qtm(shp = temp, fill = 'Media_NDVI.LTT')
media <- 'Media_NDVI.LTT'
mediana <- 'Mediana_NDVI.LTT'
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_NDVI.LTT)) +
geom_histogram(binwidth = 0.05)
ggplot(as.data.frame(temp), aes(x = Mediana_NDVI.LTT)) +
geom_histogram(binwidth = 0.05)
filename <- 'NDVI_Mean_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
qtm(shp = temp, fill = 'Media_NDVI.Mean')
media <- 'Media_NDVI.Mean'
mediana <- 'Mediana_NDVI.Mean'
summary(temp[, c(media, mediana)])
filename <- 'MO_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_MO <- replace(temp$Media_MO, temp$Media_MO == -Inf, NA)
temp$Mediana_MO <- replace(temp$Mediana_MO, temp$Mediana_MO == -Inf, NA)
qtm(shp = temp, fill = 'Media_MO')
# mapview(temp, zcol = 'Media_MO')
media <- paste('Media_', filename, sep = '')
mediana <- paste('Mediana_', filename, sep = '')
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_MO)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_MO)) +
geom_histogram(binwidth = 0.5)
filename <- 'Pendiente_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
temp$Media_Pendiente <- replace(temp$Media_Pendiente, temp$Media_Pendiente == -Inf, NA)
names(temp)
temp$Media_PEND <- replace(temp$Media_PEND, temp$Media_PEND == -Inf, NA)
temp$Mediana_PEND <- replace(temp$Mediana_PEND, temp$Mediana_PEND == -Inf, NA)
qtm(shp = temp, fill = 'Media_PEND')
media <- 'Media_PEND'
mediana <- 'Mediana_PEND'
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_PEND)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_PEND)) +
geom_histogram(binwidth = 0.5)
filename <- 'recurrencia_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_recurrecia <- replace(temp$Media_recurrecia, temp$Media_recurrecia == -Inf, NA)
temp$Media_Recurreciaa <- replace(temp$Media_Recurreciaa, temp$Media_Recurreciaa == -Inf, NA)
temp$Media_Recurrecia <- replace(temp$Media_Recurrecia, temp$Media_Recurrecia == -Inf, NA)
temp$Mediana_Recurrecia <- replace(temp$Mediana_Recurrecia, temp$Mediana_Recurrecia == -Inf, NA)
qtm(shp = temp, fill = 'Media_Recurrecia')
media <- 'Media_Recurrecia'
mediana <- 'Mediana_Recurrecia'
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_Recurrecia)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_Recurrecia)) +
geom_histogram(binwidth = 0.5)
filename <- 'VUT_descrpt'
temp <- readOGR(
dsn = paste(path, filename, '.gpkg', sep = ''),
layer = filename
)
names(temp)
temp$Media_VUT <- replace(temp$Media_VUT, temp$Media_VUT == -Inf, NA)
temp$Mediana_VUT <- replace(temp$Mediana_VUT, temp$Mediana_VUT == -Inf, NA)
qtm(shp = temp, fill = 'Media_VUT')
media <- 'Media_VUT'
mediana <- 'Mediana_VUT'
summary(temp[, c(media, mediana)])
ggplot(as.data.frame(temp), aes(x = Media_VUT)) +
geom_histogram(binwidth = 0.5)
ggplot(as.data.frame(temp), aes(x = Mediana_VUT)) +
geom_histogram(binwidth = 0.5)
